<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>#anomalyfinder</title>
    <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="dropzone/basic.css">
   <style type="text/css">
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }
    
    </style>
  </head>

  <body>
    <h1 class="title"> #anomalyfinder</h1>
    <div id="map"></div>
    <script>

      stylers = [
  {
    "stylers": [
      { "saturation": -100 },
      { "visibility": "simplified" }
    ]
  }
  //,
  // {
  //   "elementType": "labels",
  //   "stylers": [
  //     { "visibility": "off" }
  //   ]
  // },
  // {
  //   "featureType": "landscape.natural.terrain",
  //   "stylers": [
  //     { "visibility": "off" }
  //   ]
  // },
  // {
  //   "featureType": "water",
  //   "stylers": [
  //     { "color": "#1a75cf" }
  //   ]
  // },
  // {
  //   "featureType": "administrative.locality",
  //   "elementType": "labels.text",
  //   "stylers": [
  //     { "visibility": "on" }
  //   ]
  // }
];

      // This example requires the Visualization library. Include the libraries=visualization
      // parameter when you first load the API. For example:
      // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=visualization">

      var map, heatmap;

      
function doSetTimeout(i) {

  var image = {
    url:  "icon.png",
    // This marker is 20 pixels wide by 32 pixels high.
    size: new google.maps.Size(120, 120),
    // The origin for this image is (0, 0).
    origin: new google.maps.Point(0, 0),
    scaledSize: new google.maps.Size(30, 30),
    // The anchor for this image is the base of the flagpole at (0, 32).
    anchor: new google.maps.Point(15, 15)
  };

  setTimeout(function() { 
     var marker1 = new google.maps.Marker({
              position: new google.maps.LatLng(data[i].latitude, data[i].longitude),
              map: map,
              title: 'Power: ' + data[i].power ,
              icon: image

            });
    
  }, Math.floor(Math.random() * 5000) + 1000  );
}

       
     
      function initMap() {

       
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 5,
          center: {lat: -25.274398, lng: 133.775136},
         // mapTypeId: google.maps.MapTypeId.SATELLITE,
          disableDefaultUI: true,
          styles: stylers
        });

        heatmap = new google.maps.visualization.HeatmapLayer({
          data: getPoints(),
          map: map
        });


          // var marker1 = new google.maps.Marker({
          //     position: new google.maps.LatLng(data[0].latitude, data[0].longitude),
          //     map: map,
          //     title: 'ðŸ’¥',
          //     icon: image

          // });
      }

    
      // Heatmap data: 500 Points
      function getPoints() {
        //console.log(data);

         

        var heatMapData = [];

        for (var i = data.length - 1; i >= 0; i--) {
          heatMapData.push({location: new google.maps.LatLng(data[i].latitude, data[i].longitude), weight: data[i].power});

          if(i%2000 === 0){
           doSetTimeout(i);
          }
        }
        return heatMapData;
      }
    </script>
    
    <script type="text/javascript" src="data.js"></script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBI6pqjx_rXOl3m7nQecEv0Kj-h46w6LFM&libraries=visualization&callback=initMap">
    </script>
    
  </body>
</html>